## 介绍

简悦天气目前支持查看未来四天的天气情况，不过暂不支持 pm2.5，空气质量等其他信息（与接口有关）。本程序采用的是个人开发者提供的[天气接口](https://www.sojson.com/api/weather.html)，将来可能会为了支持更多功能对接口进行更换。预览图如下所示：

![image](http://p70i67yyb.bkt.clouddn.com/QQ%E6%88%AA%E5%9B%BE20180411232932.jpg)

## 待做功能

1. 城市管理
2. 天气详细信息的展示（pm2.5, 湿度，空气质量，紫外线强度等）
3. 动画效果

## 相关技术

下面介绍一些在开发过程中遇到的问题，技术，总结等。

#### 关于 Navigation 自定义

问题：由于本程序的上半部分是一张图片，为了让 `Navigation` 的背景一致，将 `navigationStyle` 设置为 `custom`。虽说是自定义，但是微信会保留右上角胶囊状按钮，所以涉及一个问题，如果我们想要在原来的 `NavigationTitle` 位置放置城市信息（与右上角胶囊状保持垂直对齐），该怎么设置？

解决方法：在 `onLoad` 声明周期内调用 `getSystemInfo()` 拿到 `statusBarHeight`，然后为包含城市信息的 `view` 设置 `margin-top: statusBarHeight`，最后为该 `view` 设置高度，调整居中效果。

#### 使用 Promise

问题：关于位置信息的获取，天气信息的获取，不应该将这些功能放置在某个页面下，而是应该提取出来作为辅助函数，只需要引入就可以直接使用。因为上述功能都是需要异步获取数据的，在 `ES5` 中我们需要使用传递回调函数的方法，在 `ES6` 中可以使用 `Promise`，之后又可以使用 `Async/Await`。小程序开发工具中有一项设置可以将 `ES6` 代码转 `ES5`。

解决方法：直接在函数中 `return new Promise((resolve) => {})`, 然后将具体的方法放在大括号内，成功则调用 `resolve()` 即可。

#### 位置信息的获取

问题：微信自带的获取位置方法只能拿到经纬度和高度信息，并不能直接获取当前位置的省份，城市等。

解决方法：采用腾讯位置服务提供的[逆地址解析](http://lbs.qq.com/qqmap_wx_jssdk/method-reverseGeocoder.html)
